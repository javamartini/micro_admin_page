<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>micro8deb Administration</title>
	<link rel="stylesheet" type="text/css" href="../css/style.css" />
</head>
<body style="padding: 0">
<!-- navbar -->
<nav class="navbar">
    <div class="nav" id="navbar">
        <a href="./micro8deb_admin" class="active">micro8deb</a>
        <a href="./raspberrypi5_admin">raspberrypi5</a>
        <a href="./">Overall Status</a>
        <a href="https://weather.micro8deb.com">
			<img src="../icons/arrow-up-right-from-square-solid.svg" alt="external link icon"
				 style="width: 16px; height: 16px; margin-right: 5px; filter: invert(1);"/>
			Micro Weather Service</a>
		<a href="./logout" id="linkLogout">
			<img src="../icons/arrow-up-right-from-square-solid.svg" alt="external link icon"
				 style="width: 16px; height: 16px; margin-right: 5px; filter: invert(1);"/>
			Log Out</a>
        <a href="javascript:void(0);" class="icon" onclick="responsiveNavbar()">
            <i><img src="../icons/bars-solid.svg" alt="extend menu icon"
					style="width: 16px; height: 16px; filter: invert(1);"/></i>
        </a>
    </div>
</nav>
<script>
	//will create a responsive navbar depending on the screen-size
    function responsiveNavbar() {
        let navNavBar = document.getElementById("navbar");
		//if navbar has class nav, add the responsive class
        if (navNavBar.className === "nav") {
            navNavBar.className += " responsive";
		//if navbar does not have class nav, leave it alone
        } else {
            navNavBar.className = "nav";
        }
    }

	//logging out the user
	document.getElementById("linkLogout").addEventListener("click", async function (event) {
		event.preventDefault(); //prevents normal link behavior
		try {
			const objResponse = await fetch("http://localhost:8080/logout", {
				method: "POST"
			});

			const objData = await objResponse.json(); //grab the data from the response

			if (objResponse.status === 200) {
				//if the response status is 200, redirect them with a parameter
				window.location.href = objData.redirect_url;
			} else {
				//else, let the user know that the logout failed for some odd, strange, and unexplainable reason ;)
				alert("For some reason, the logout has failed.");
			}
		} catch (error) {
			//if there was a network or server error, let the user know
			alert("There was a fatal error with the server when trying to log out out.");
		}
	});
</script>
</body>
</html>